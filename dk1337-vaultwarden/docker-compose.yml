version: "3.7"

services:
  app-proxy:
    image: getumbrel/umbrel-app-proxy:1.0.5
    restart: always
    environment:
      - APP_HOST=dk1337-vaultwarden_server_1
      - APP_PORT=80
      - PROXY_AUTH_ADD: "false"
    ports:
      - "1337:80"

  server:
    image: vaultwarden/server:latest
    restart: always
    volumes:
      - vaultwarden-data:/data
    environment:
      - EMERGENCY_ACCESS_ALLOWED=true
      - WEB_VAULT_ENABLED=true
      - PUSH_ENABLED=true
      - PUSH_RELAY_URI=https://push.bitwarden.eu
      - PUSH_IDENTITY_URI=https://identity.bitwarden.eu
    expose:
      - "80"

volumes:
  vaultwarden-data:
